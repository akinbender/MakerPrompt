@inject IAppConfigurationService ConfigService

<nav class="sidebar @(Collapsed ? "sidebar--collapsed" : "")">
    <div class="d-flex flex-column h-100 py-2">
        <ul class="nav flex-column px-2 mb-auto">
            <li class="nav-item">
                <NavLink class="nav-link sidebar-link px-3 py-2 rounded" href="" Match="NavLinkMatch.All">
                    <i class="bi bi-printer sidebar-icon"></i>
                    <span class="sidebar-label">@Resources.PageTitle_Fleet</span>
                </NavLink>
            </li>
            @if (ConfigService.Configuration.EnableFilamentInventory)
            {
                <li class="nav-item">
                    <NavLink class="nav-link sidebar-link px-3 py-2 rounded" href="filament">
                        <i class="bi bi-vinyl-fill sidebar-icon"></i>
                        <span class="sidebar-label">Filament Inventory</span>
                    </NavLink>
                </li>
            }
            @if (ConfigService.Configuration.EnablePrintAnalytics)
            {
                <li class="nav-item">
                    <NavLink class="nav-link sidebar-link px-3 py-2 rounded" href="analytics">
                        <i class="bi bi-bar-chart-line sidebar-icon"></i>
                        <span class="sidebar-label">Analytics</span>
                    </NavLink>
                </li>
            }
            <li class="nav-item">
                <NavLink class="nav-link sidebar-link px-3 py-2 rounded" href="cheatsheet">
                    <i class="bi bi-list-ul sidebar-icon"></i>
                    <span class="sidebar-label">@Resources.PageTitle_GCodeList</span>
                </NavLink>
            </li>
            <li class="nav-item">
                <NavLink class="nav-link sidebar-link px-3 py-2 rounded" href="calculators">
                    <i class="bi bi-calculator sidebar-icon"></i>
                    <span class="sidebar-label">@Resources.PageTitle_Calculators</span>
                </NavLink>
            </li>
            <li class="nav-item">
                <NavLink class="nav-link sidebar-link px-3 py-2 rounded" href="braillerap">
                    <i class="bi bi-grid-3x3-gap sidebar-icon"></i>
                    <span class="sidebar-label">@Resources.PageTitle_BrailleRAP</span>
                </NavLink>
            </li>
            <li class="nav-item">
                <NavLink class="nav-link sidebar-link px-3 py-2 rounded" href="about">
                    <i class="bi bi-info-circle sidebar-icon"></i>
                    <span class="sidebar-label">@Resources.PageTitle_About</span>
                </NavLink>
            </li>
            <li class="nav-item">
                <NavLink class="nav-link sidebar-link px-3 py-2 rounded" href="settings">
                    <i class="bi bi-gear sidebar-icon"></i>
                    <span class="sidebar-label">Settings</span>
                </NavLink>
            </li>
        </ul>
        <hr class="mx-2 my-1" />
        <div class="px-2 d-flex align-items-center gap-2">
            <button class="btn btn-link sidebar-toggle-btn flex-shrink-0 px-3 py-2 rounded" @onclick="OnToggle" title="Toggle navigation">
                <i class="bi @(Collapsed ? "bi-chevron-double-right" : "bi-chevron-double-left") sidebar-icon"></i>
            </button>
            <small class="sidebar-label text-muted" style="font-size:0.75rem;">@($"v{Version}")</small>
        </div>
    </div>
</nav>

@code {
    [Parameter] public bool Collapsed { get; set; }
    [Parameter] public EventCallback OnToggle { get; set; }

    private string Version = "0.0.0";

    protected override void OnInitialized()
    {
        var assembly = Assembly.GetEntryAssembly();
        Version = assembly?.GetName()?.Version?.ToString(3) ?? Version;
    }
}
