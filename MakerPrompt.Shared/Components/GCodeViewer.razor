@inject MakerPromptJsInterop JS
@implements IAsyncDisposable

<div @ref="viewerContainer" id="gcode-container"></div>

<button @onclick="LoadGCode">Load GCode</button>

@code {
    private ElementReference viewerContainer;
    private string? gcodeContent;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (gcodeContent != null)
        {
            await JS.InitializeViewerAsync(viewerContainer, gcodeContent);
        }
    }

    private async Task LoadGCode()
    {
        gcodeContent = "; external perimeters extrusion width = 0.45mm\n; perimeters extrusion width = 0.45mm\n; infill extrusion width = 0.45mm\n; solid infill extrusion width = 0.45mm\n; top infill extrusion width = 0.42mm\n; first layer extrusion width = 0.50mm\n\nM73 P0 R6\nM201 X4000 Y4000 Z400 E5000 ; sets maximum accelerations, mm/sec^2\nM203 X400 Y400 Z12 E80 ; sets maximum feedrates, mm / sec\nM204 P4000 R1250 T4000 ; sets acceleration (P, T) and retract acceleration (R), mm/sec^2\nM205 X8.00 Y8.00 Z2.00 E10.00 ; sets the jerk limits, mm/sec\nM205 S0 T0 ; sets the minimum extruding and travel feed rate, mm/sec\n\nM486 S0\nM486 AFirstLayerCalibration-FirstLayer.stl\nM486 S-1\n\n;TYPE:Custom\nM862.3 P \"MINI\" ; printer model check\nM862.1 P0.4 ; nozzle diameter check\nM862.5 P2 ; g-code level check\nM862.6 P\"Input shaper\" ; FW feature check\nM115 U5.1.2+13478\nG90 ; use absolute coordinates\nM83 ; extruder relative mode\nM104 S170 ; set extruder temp for bed leveling\nM140 S60 ; set bed temp\nM109 R170 ; wait for bed leveling temp\nM190 S60 ; wait for bed temp\nM569 S1 X Y ; set stealthchop for X Y\nM204 T1250 ; set travel acceleration\nG28 ; home all without mesh bed level\nG29 ; mesh bed leveling \nM104 S230 ; set extruder temp\nG92 E0\n\nG1 X0 Y-2 Z3 F2400\n\nM109 S230 ; wait for extruder temp\n\n; intro line\nG1 X10 Z0.2 F1000\nG1 X70 E8 F900\nG1 X140 E10 F700\nM73 P1 R6\nG92 E0\n\nM569 S0 X Y ; set spreadcycle for X Y\nM204 T4000 ; restore travel acceleration\nM572 W0.06 ; set smooth time\nM221 S95 ; set flow\nG21 ; set units to millimeters\nG90 ; use absolute coordinates\nM83 ; use relative distances for extrusion\nM572 S0.3\nM107\n;LAYER_CHANGE\n;Z:0.2\n;HEIGHT:0.2\n;BEFORE_LAYER_CHANGE\nG92 E0.0\n;0.2\nM201 X4000 Y4000\nM74 W0\n\nG1 E-2.5 F4200\nM73 P2 R6\nG1 Z.2 F720\n;AFTER_LAYER_CHANGE\n;0.2\nM486 S0\nG1 X70.45 Y114.921 F24000\nG1 Z.2 F720\nG1 E2.5 F2400\nM204 P500\n;TYPE:External perimeter\n;WIDTH:0.499999\nG1 F1800\nG1 X70.45 Y113.57 E.05135\nG1 X70.377 Y113.411 E.00665\nG1 X70.221 Y113.35 E.00637\nG1 X60.45 Y113.35 E.37136\nG1 X60.45 Y105.45 E.30025\nM73 P3 R6\nG1 X70.221 Y105.45 E.37136\nG2 X70.391 Y105.374 I-.059 J-.363 E.00716\nG1 X70.45 Y105.221 E.00623\nG1 X70.45 Y103.871 E.05131\nG1 X70.376 Y103.71 E.00673\nG1 X70.221 Y103.65 E.00632\nG1 X60.45 Y103.65 E.37136\nG1 X60.45 Y95.75 E.30025\nG1 X70.221 Y95.75 E.37136\nG2 X70.391 Y95.675 I-.059 J-.364 E.00714\nG1 X70.45 Y95.521 E.00627\nG1 X70.45 Y94.171 E.05131\nG1 X70.376 Y94.01 E.00673\nG1 X70.221 Y93.95 E.00632\nG1 X60.45 Y93.95 E.37136\nG1 X60.45 Y86.05 E.30025\nG1 X70.221 Y86.05 E.37136\nG2 X70.391 Y85.975 I-.059 J-.364 E.00714\nG1 X70.45 Y85.821 E.00627\nG1 X70.45 Y84.471 E.05131\nG1 X70.376 Y84.31 E.00673\nG1 X70.221 Y84.25 E.00632\nG1 X60.45 Y84.25 E.37136\nG1 X60.45 Y76.35 E.30025\nG1 X70.221 Y76.35 E.37136\nG2 X70.391 Y76.275 I-.059 J-.364 E.00714\nM73 P4 R6\nG1 X70.45 Y76.121 E.00627\nG1 X70.45 Y74.772 E.05127\nG1 X70.377 Y74.611 E.00672\nG1 X70.221 Y74.55 E.00637\nG1 X60.45 Y74.55 E.37136\nG1 X60.45 Y66.65 E.30025\nG1 X70.221 Y66.65 E.37136\nG2 X70.391 Y66.574 I-.059 J-.363 E.00716\nG1 X70.45 Y66.421 E.00623\nG1 X70.45 Y65.079 E.051\nG1 X70.387 Y64.921 E.00646\nG1 X70.221 Y64.85 E.00686\nG1 X60.45 Y64.85 E.37136\nG1 X60.45 Y56.95 E.30025\nG1 X70.221 Y56.95 E.37136\nG1 X70.387 Y56.879 E.00686\nG1 X70.45 Y56.721 E.00646\nG1 X70.45 Y55.379 E.051\nG1 X70.379 Y55.213 E.00686\nG1 X70.221 Y55.15 E.00646\nG1 X60.45 Y55.15 E.37136\nG1 X60.45 Y47.25 E.30025\nG1 X119.55 Y47.25 E2.24617\nG1 X119.55 Y71.885 E.93628\nM73 P5 R6\nG1 X119.55 Y132.75 E2.31325\nG1 X60.45 Y132.75 E2.24617\nG1 X60.45 Y124.85 E.30025\nM73 P6 R6\nG1 X70.221 Y124.85 E.37136\nG1 X70.379 Y124.787 E.00646\nG1 X70.45 Y124.621 E.00686\nG1 X70.45 Y123.279 E.051\nG1 X70.387 Y123.121 E.00646\nG1 X70.221 Y123.05 E.00686\nG1 X60.45 Y123.05 E.37136\nG1 X60.45 Y115.15 E.30025\nG1 X70.221 Y115.15 E.37136\nG1 X70.387 Y115.079 E.00686\nG1 X70.428 Y114.977 E.00418\nM204 P2000\nG1 E-2.5 F4200\nM204 T4000\nG1 X70.428 Y114.977 Z.4 F24010.798\nG1 X119.367 Y47.639 F24000\nG1 Z.2 F720\nM73 P7 R6\nG1 E2.5 F2400\nM204 P500\n;TYPE:Solid infill\n;WIDTH:0.500877\nG1 F1800\nG1 X60.839 Y47.639 E2.2287\nG1 X60.839 Y48.097 E.01744\nG1 X119.161 Y48.097 E2.22086\nG1 X119.161 Y48.555 E.01744\nM73 P8 R6\nG1 X60.839 Y48.555 E2.22086\nG1 X60.839 Y49.013 E.01744\nG1 X119.161 Y49.013 E2.22086\nG1 X119.161 Y49.471 E.01744\nM73 P9 R5\nG1 X60.839 Y49.471 E2.22086\nG1 X60.839 Y49.929 E.01744\nG1 X119.161 Y49.929 E2.22086\nG1 X119.161 Y50.387 E.01744\nM73 P10 R5\nG1 X60.839 Y50.387 E2.22086\nG1 X60.839 Y50.845 E.01744\nG1 X119.161 Y50.845 E2.22086\nG1 X119.161 Y51.303 E.01744\nM73 P11 R5\nG1 X60.839 Y51.303 E2.22086\nG1 X60.839 Y51.761 E.01744\nG1 X119.161 Y51.761 E2.22086\nG1 X119.161 Y52.219 E.01744\nM73 P12 R5\nG1 X60.839 Y52.219 E2.22086\nG1 X60.839 Y52.677 E.01744\nG1 X119.161 Y52.677 E2.22086\nG1 X119.161 Y53.134 E.0174\nM73 P13 R5\nG1 X60.839 Y53.134 E2.22086\nG1 X60.839 Y53.592 E.01744\nG1 X119.161 Y53.592 E2.22086\nG1 X119.161 Y54.05 E.01744\nM73 P14 R5\nG1 X60.839 Y54.05 E2.22086\nG1 X60.839 Y54.508 E.01744\nG1 X119.161 Y54.508 E2.22086\nG1 X119.161 Y54.966 E.01744\nM73 P15 R5\nG1 X70.676 Y54.966 E1.84627\nG3 X70.839 Y55.424 I-.462 J.422 E.01901\nG1 X119.161 Y55.424 E1.84007\nG1 X119.161 Y55.882 E.01744\nM73 P16 R5\nG1 X70.839 Y55.882 E1.84007\nG1 X70.839 Y56.34 E.01744\nG1 X119.161 Y56.34 E1.84007\nG1 X119.161 Y56.798 E.01744\nG1 X70.833 Y56.798 E1.8403\nG3 X70.522 Y57.256 I-.601 J-.073 E.0219\nM73 P17 R5\nG1 X119.161 Y57.256 E1.85214\nG1 X119.161 Y57.714 E.01744\nG1 X60.839 Y57.714 E2.22086\nG1 X60.839 Y58.172 E.01744\nM73 P18 R5\nG1 X119.161 Y58.172 E2.22086\nG1 X119.161 Y58.63 E.01744\nG1 X60.839 Y58.63 E2.22086\nG1 X60.839 Y59.088 E.01744\nM73 P19 R5\nG1 X119.161 Y59.088 E2.22086\nG1 X119.161 Y59.546 E.01744\nG1 X60.839 Y59.546 E2.22086\nG1 X60.839 Y60.004 E.01744\nM73 P20 R5\nG1 X119.161 Y60.004 E2.22086\nG1 X119.161 Y60.462 E.01744\nG1 X60.839 Y60.462 E2.22086\nG1 X60.839 Y60.92 E.01744\nM73 P21 R5\nG1 X119.161 Y60.92 E2.22086\nG1 X119.161 Y61.378 E.01744\nG1 X60.839 Y61.378 E2.22086\nG1 X60.839 Y61.836 E.01744\nM73 P22 R5\nG1 X119.161 Y61.836 E2.22086\nG1 X119.161 Y62.294 E.01744\nG1 X60.839 Y62.294 E2.22086\nG1 X60.839 Y62.752 E.01744\nM73 P23 R5\nG1 X119.161 Y62.752 E2.22086\nG1 X119.161 Y63.21 E.01744\nG1 X60.839 Y63.21 E2.22086\nG1 X60.839 Y63.668 E.01744\nM73 P24 R4\nG1 X119.161 Y63.668 E2.22086\nG1 X119.161 Y64.125 E.0174\nG1 X60.839 Y64.125 E2.22086\nG1 X60.839 Y64.462 E.01283\nM73 P25 R4\nG1 X70.327 Y64.468 E.3613\nG3 X70.58 Y64.583 I-.114 J.587 E.01068\nG1 X119.161 Y64.583 E1.84993\nG1 X119.161 Y65.041 E.01744\nG1 X70.836 Y65.041 E1.84018\nG1 X70.839 Y65.499 E.01744\nM73 P26 R4\nG1 X119.161 Y65.499 E1.84007\nG1 X119.161 Y65.957 E.01744\nG1 X70.839 Y65.957 E1.84007\nG1 X70.839 Y66.415 E.01744\nM73 P27 R4\nG1 X119.161 Y66.415 E1.84007\nG1 X119.161 Y66.873 E.01744\nG1 X70.643 Y66.873 E1.84753\nG3 X70.236 Y67.039 I-.435 J-.487 E.01707\nM73 P28 R4\nG1 X60.839 Y67.039 E.35783\nG1 X60.839 Y67.331 E.01112\nG1 X119.161 Y67.331 E2.22086\nG1 X119.161 Y67.789 E.01744\nG1 X60.839 Y67.789 E2.22086\nG1 X60.839 Y68.247 E.01744\nM73 P29 R4\nG1 X119.161 Y68.247 E2.22086\nG1 X119.161 Y68.705 E.01744\nG1 X60.839 Y68.705 E2.22086\nG1 X60.839 Y69.163 E.01744\nM73 P30 R4\nG1 X119.161 Y69.163 E2.22086\nG1 X119.161 Y69.621 E.01744\nG1 X60.839 Y69.621 E2.22086\nG1 X60.839 Y70.079 E.01744\nM73 P31 R4\nG1 X119.161 Y70.079 E2.22086\nG1 X119.161 Y70.537 E.01744\nG1 X60.839 Y70.537 E2.22086\nG1 X60.839 Y70.995 E.01744\nM73 P32 R4\nG1 X119.161 Y70.995 E2.22086\nG1 X119.161 Y71.453 E.01744\nG1 X60.839 Y71.453 E2.22086\nG1 X60.839 Y71.911 E.01744\nM73 P33 R4\nG1 X119.161 Y71.911 E2.22086\nG1 X119.161 Y72.369 E.01744\nG1 X60.839 Y72.369 E2.22086\nG1 X60.839 Y72.827 E.01744\nM73 P34 R4\nG1 X119.161 Y72.827 E2.22086\nG1 X119.161 Y73.285 E.01744\nG1 X60.839 Y73.285 E2.22086\nG1 X60.839 Y73.743 E.01744\nM73 P35 R4\nG1 X119.161 Y73.743 E2.22086\nG1 X119.161 Y74.201 E.01744\nG1 X70.438 Y74.201 E1.85534\nG3 X70.827 Y74.658 I-.224 J.583 E.02383\nM73 P36 R4\nG1 X119.161 Y74.658 E1.84052\nG1 X119.161 Y75.116 E.01744\nG1 X70.839 Y75.116 E1.84007\nG1 X70.839 Y75.574 E.01744\nM73 P37 R4\nG1 X119.161 Y75.574 E1.84007\nG1 X119.161 Y76.032 E.01744\nG1 X70.839 Y76.032 E1.84007\nG3 X70.709 Y76.49 I-.638 J.067 E.01857\nG1 X119.161 Y76.49 E1.84502\nG1 X119.161 Y76.948 E.01744\nM73 P38 R4\nG1 X60.839 Y76.948 E2.22086\nG1 X60.839 Y77.406 E.01744\nG1 X119.161 Y77.406 E2.22086\nG1 X119.161 Y77.864 E.01744\nM73 P39 R3\nG1 X60.839 Y77.864 E2.22086\nG1 X60.839 Y78.322 E.01744\nG1 X119.161 Y78.322 E2.22086\nG1 X119.161 Y78.78 E.01744\nM73 P40 R3\nG1 X60.839 Y78.78 E2.22086\nG1 X60.839 Y79.238 E.01744\nG1 X119.161 Y79.238 E2.22086\nG1 X119.161 Y79.696 E.01744\nM73 P41 R3\nG1 X60.839 Y79.696 E2.22086\nG1 X60.839 Y80.154 E.01744\nG1 X119.161 Y80.154 E2.22086\nG1 X119.161 Y80.612 E.01744\nM73 P42 R3\nG1 X60.839 Y80.612 E2.22086\nG1 X60.839 Y81.07 E.01744\nG1 X119.161 Y81.07 E2.22086\nG1 X119.161 Y81.528 E.01744\nM73 P43 R3\nG1 X60.839 Y81.528 E2.22086\nG1 X60.839 Y81.986 E.01744\nM73 P44 R3\nG1 X119.161 Y81.986 E2.22086\nG1 X119.161 Y82.444 E.01744\nG1 X60.839 Y82.444 E2.22086\nG1 X60.839 Y82.902 E.01744\nM73 P45 R3\nG1 X119.161 Y82.902 E2.22086\nG1 X119.161 Y83.36 E.01744\nG1 X60.839 Y83.36 E2.22086\nG1 X60.839 Y83.818 E.01744\nM73 P46 R3\nG1 X119.161 Y83.818 E2.22086\nG1 X119.161 Y84.276 E.01744\nG1 X70.799 Y84.276 E1.84159\nG3 X70.839 Y84.734 I-1.092 J.324 E.01763\nG1 X119.161 Y84.734 E1.84007\nM73 P47 R3\nG1 X119.161 Y85.191 E.0174\nG1 X70.839 Y85.191 E1.84007\nG1 X70.839 Y85.649 E.01744\nG1 X119.161 Y85.649 E1.84007\nG1 X119.161 Y86.107 E.01744\nM73 P48 R3\nG1 X70.767 Y86.107 E1.84281\nG3 X70.236 Y86.439 I-.549 J-.288 E.025\nG1 X60.839 Y86.439 E.35783\nG1 X60.839 Y86.565 E.0048\nG1 X119.161 Y86.565 E2.22086\nG1 X119.161 Y87.023 E.01744\nM73 P49 R3\nG1 X60.839 Y87.023 E2.22086\nG1 X60.839 Y87.481 E.01744\nG1 X119.161 Y87.481 E2.22086\nG1 X119.161 Y87.939 E.01744\nM73 P50 R3\nG1 X60.839 Y87.939 E2.22086\nG1 X60.839 Y88.397 E.01744\nG1 X119.161 Y88.397 E2.22086\nG1 X119.161 Y88.855 E.01744\nM73 P51 R3\nG1 X60.839 Y88.855 E2.22086\nG1 X60.839 Y89.313 E.01744\nG1 X119.161 Y89.313 E2.22086\nG1 X119.161 Y89.771 E.01744\nM73 P52 R3\nG1 X60.839 Y89.771 E2.22086\nG1 X60.839 Y90.229 E.01744\nG1 X119.161 Y90.229 E2.22086\nG1 X119.161 Y90.687 E.01744\nM73 P53 R3\nG1 X60.839 Y90.687 E2.22086\nG1 X60.839 Y91.145 E.01744\nG1 X119.161 Y91.145 E2.22086\nG1 X119.161 Y91.603 E.01744\nM73 P54 R3\nG1 X60.839 Y91.603 E2.22086\nG1 X60.839 Y92.061 E.01744\nM73 P54 R2\nG1 X119.161 Y92.061 E2.22086\nG1 X119.161 Y92.519 E.01744\nM73 P55 R2\nG1 X60.839 Y92.519 E2.22086\nG1 X60.839 Y92.977 E.01744\nG1 X119.161 Y92.977 E2.22086\nG1 X119.161 Y93.435 E.01744\nM73 P56 R2\nG1 X60.839 Y93.435 E2.22086\nG1 X60.839 Y93.562 E.00484\nG1 X70.332 Y93.569 E.36149\nG3 X70.769 Y93.893 I-.136 J.64 E.02136\nM73 P57 R2\nG1 X119.161 Y93.893 E1.84273\nG1 X119.161 Y94.351 E.01744\nG1 X70.839 Y94.351 E1.84007\nG1 X70.839 Y94.809 E.01744\nG1 X119.161 Y94.809 E1.84007\nG1 X119.161 Y95.267 E.01744\nM73 P58 R2\nG1 X70.839 Y95.267 E1.84007\nG3 X70.825 Y95.653 I-2.422 J.11 E.01472\nG1 X70.802 Y95.724 E.00284\nG1 X119.161 Y95.724 E1.84148\nG1 X119.161 Y96.182 E.01744\nM73 P59 R2\nG1 X60.839 Y96.182 E2.22086\nG1 X60.839 Y96.64 E.01744\nG1 X119.161 Y96.64 E2.22086\nG1 X119.161 Y97.098 E.01744\nM73 P60 R2\nG1 X60.839 Y97.098 E2.22086\nG1 X60.839 Y97.556 E.01744\nG1 X119.161 Y97.556 E2.22086\nG1 X119.161 Y98.014 E.01744\nM73 P61 R2\nG1 X60.839 Y98.014 E2.22086\nG1 X60.839 Y98.472 E.01744\nG1 X119.161 Y98.472 E2.22086\nG1 X119.161 Y98.93 E.01744\nM73 P62 R2\nG1 X60.839 Y98.93 E2.22086\nG1 X60.839 Y99.388 E.01744\nG1 X119.161 Y99.388 E2.22086\nG1 X119.161 Y99.846 E.01744\nM73 P63 R2\nG1 X60.839 Y99.846 E2.22086\nG1 X60.839 Y100.304 E.01744\nG1 X119.161 Y100.304 E2.22086\nG1 X119.161 Y100.762 E.01744\nM73 P64 R2\nG1 X60.839 Y100.762 E2.22086\nG1 X60.839 Y101.22 E.01744\nG1 X119.161 Y101.22 E2.22086\nG1 X119.161 Y101.678 E.01744\nM73 P65 R2\nG1 X60.839 Y101.678 E2.22086\nG1 X60.839 Y102.136 E.01744\nG1 X119.161 Y102.136 E2.22086\nG1 X119.161 Y102.594 E.01744\nM73 P66 R2\nG1 X60.839 Y102.594 E2.22086\nG1 X60.839 Y103.052 E.01744\nG1 X119.161 Y103.052 E2.22086\nG1 X119.161 Y103.51 E.01744\nM73 P67 R2\nG1 X70.709 Y103.51 E1.84502\nG3 X70.839 Y103.968 I-.508 J.391 E.01857\nG1 X119.161 Y103.968 E1.84007\nG1 X119.161 Y104.426 E.01744\nM73 P68 R2\nG1 X70.839 Y104.426 E1.84007\nG1 X70.839 Y104.884 E.01744\nG1 X119.161 Y104.884 E1.84007\nG1 X119.161 Y105.342 E.01744\nM73 P69 R2\nG1 X70.827 Y105.342 E1.84052\nG3 X70.438 Y105.8 I-.613 J-.127 E.02387\nG1 X119.161 Y105.8 E1.85534\nG1 X119.161 Y106.258 E.01744\nM73 P69 R1\nG1 X60.839 Y106.258 E2.22086\nG1 X60.839 Y106.715 E.0174\nM73 P70 R1\nG1 X119.161 Y106.715 E2.22086\nG1 X119.161 Y107.173 E.01744\nG1 X60.839 Y107.173 E2.22086\nG1 X60.839 Y107.631 E.01744\nM73 P71 R1\nG1 X119.161 Y107.631 E2.22086\nG1 X119.161 Y108.089 E.01744\nG1 X60.839 Y108.089 E2.22086\nG1 X60.839 Y108.547 E.01744\nM73 P72 R1\nG1 X119.161 Y108.547 E2.22086\nG1 X119.161 Y109.005 E.01744\nG1 X60.839 Y109.005 E2.22086\nG1 X60.839 Y109.463 E.01744\nM73 P73 R1\nG1 X119.161 Y109.463 E2.22086\nG1 X119.161 Y109.921 E.01744\nG1 X60.839 Y109.921 E2.22086\nG1 X60.839 Y110.379 E.01744\nM73 P74 R1\nG1 X119.161 Y110.379 E2.22086\nG1 X119.161 Y110.837 E.01744\nM73 P75 R1\nG1 X60.839 Y110.837 E2.22086\nG1 X60.839 Y111.295 E.01744\nG1 X119.161 Y111.295 E2.22086\nG1 X119.161 Y111.753 E.01744\nM73 P76 R1\nG1 X60.839 Y111.753 E2.22086\nG1 X60.839 Y112.211 E.01744\nG1 X119.161 Y112.211 E2.22086\nG1 X119.161 Y112.669 E.01744\nM73 P77 R1\nG1 X60.839 Y112.669 E2.22086\nG1 X60.839 Y112.962 E.01116\nG1 X70.333 Y112.969 E.36152\nG3 X70.644 Y113.127 I-.181 J.744 E.0134\nG1 X119.161 Y113.127 E1.84749\nG1 X119.161 Y113.585 E.01744\nM73 P78 R1\nG1 X70.839 Y113.585 E1.84007\nG1 X70.839 Y114.043 E.01744\nG1 X119.161 Y114.043 E1.84007\nG1 X119.161 Y114.501 E.01744\nG1 X70.839 Y114.501 E1.84007\nG1 X70.836 Y114.959 E.01744\nM73 P79 R1\nG1 X119.161 Y114.959 E1.84018\nG1 X119.161 Y115.417 E.01744\nG1 X70.589 Y115.417 E1.84959\nG3 X70.235 Y115.539 I-.387 J-.55 E.01445\nM73 P80 R1\nG1 X60.839 Y115.539 E.35779\nG1 X60.839 Y115.875 E.01279\nG1 X119.161 Y115.875 E2.22086\nG1 X119.161 Y116.333 E.01744\nG1 X60.839 Y116.333 E2.22086\nG1 X60.839 Y116.791 E.01744\nM73 P81 R1\nG1 X119.161 Y116.791 E2.22086\nG1 X119.161 Y117.248 E.0174\nG1 X60.839 Y117.248 E2.22086\nG1 X60.839 Y117.706 E.01744\nM73 P82 R1\nG1 X119.161 Y117.706 E2.22086\nG1 X119.161 Y118.164 E.01744\nG1 X60.839 Y118.164 E2.22086\nG1 X60.839 Y118.622 E.01744\nM73 P83 R1\nG1 X119.161 Y118.622 E2.22086\nG1 X119.161 Y119.08 E.01744\nG1 X60.839 Y119.08 E2.22086\nG1 X60.839 Y119.538 E.01744\nM73 P84 R1\nG1 X119.161 Y119.538 E2.22086\nG1 X119.161 Y119.996 E.01744\nG1 X60.839 Y119.996 E2.22086\nG1 X60.839 Y120.454 E.01744\nM73 P85 R0\nG1 X119.161 Y120.454 E2.22086\nG1 X119.161 Y120.912 E.01744\nG1 X60.839 Y120.912 E2.22086\nG1 X60.839 Y121.37 E.01744\nM73 P86 R0\nG1 X119.161 Y121.37 E2.22086\nG1 X119.161 Y121.828 E.01744\nG1 X60.839 Y121.828 E2.22086\nG1 X60.839 Y122.286 E.01744\nM73 P87 R0\nG1 X119.161 Y122.286 E2.22086\nG1 X119.161 Y122.744 E.01744\nG1 X70.528 Y122.744 E1.85191\nG3 X70.83 Y123.202 I-.303 J.529 E.02167\nM73 P88 R0\nG1 X119.161 Y123.202 E1.84041\nG1 X119.161 Y123.66 E.01744\nG1 X70.839 Y123.66 E1.84007\nG1 X70.839 Y124.118 E.01744\nM73 P89 R0\nG1 X119.161 Y124.118 E1.84007\nG1 X119.161 Y124.576 E.01744\nG1 X70.839 Y124.576 E1.84007\nG3 X70.678 Y125.034 I-.65 J.03 E.01895\nM73 P90 R0\nG1 X119.161 Y125.034 E1.8462\nG1 X119.161 Y125.492 E.01744\nG1 X60.839 Y125.492 E2.22086\nG1 X60.839 Y125.95 E.01744\nM73 P91 R0\nG1 X119.161 Y125.95 E2.22086\nG1 X119.161 Y126.408 E.01744\nG1 X60.839 Y126.408 E2.22086\nG1 X60.839 Y126.866 E.01744\nM73 P92 R0\nG1 X119.161 Y126.866 E2.22086\nG1 X119.161 Y127.324 E.01744\nG1 X60.839 Y127.324 E2.22086\nG1 X60.839 Y127.781 E.0174\nM73 P93 R0\nG1 X119.161 Y127.781 E2.22086\nG1 X119.161 Y128.239 E.01744\nG1 X60.839 Y128.239 E2.22086\nG1 X60.839 Y128.697 E.01744\nM73 P94 R0\nG1 X119.161 Y128.697 E2.22086\nG1 X119.161 Y129.155 E.01744\nG1 X60.839 Y129.155 E2.22086\nG1 X60.839 Y129.613 E.01744\nM73 P95 R0\nG1 X119.161 Y129.613 E2.22086\nG1 X119.161 Y130.071 E.01744\nG1 X60.839 Y130.071 E2.22086\nG1 X60.839 Y130.529 E.01744\nM73 P96 R0\nG1 X119.161 Y130.529 E2.22086\nG1 X119.161 Y130.987 E.01744\nG1 X60.839 Y130.987 E2.22086\nG1 X60.839 Y131.445 E.01744\nM73 P97 R0\nG1 X119.161 Y131.445 E2.22086\nG1 X119.161 Y131.903 E.01744\nG1 X60.839 Y131.903 E2.22086\nG1 X60.839 Y132.361 E.01744\nM73 P98 R0\nG1 X119.367 Y132.361 E2.2287\nM204 P2000\nM486 S-1\nG1 E-2.5 F4200\nM107\n;TYPE:Custom\n; Filament-specific end gcode\nG1 Z2.2 F720 ; Move print head up\nG1 X170 Y170 F4200 ; park print head\nG1 Z50.2 F720 ; Move print head further up\nG4 ; wait\nM104 S0 ; turn off temperature\nM140 S0 ; turn off heatbed\nM107 ; turn off fan\nM221 S100 ; reset flow\nM572 S0 ; reset PA\nM569 S1 X Y ; reset to stealthchop for X Y\nM84 ; disable motors\n; max_layer_z = 0.2\nM73 P100 R0\n; filament used [mm] = 436.17\n; filament used [cm3] = 1.05\n; filament used [g] = 1.30\n; filament cost = 0.03\n; total filament used [g] = 1.30\n; total filament cost = 0.03\n; total filament used for wipe tower [g] = 0.00\n; estimated printing time (normal mode) = 6m 34s\n; estimated first layer printing time (normal mode) = 6m 34s\n\n; prusaslicer_config = begin\n; arc_fitting = emit_center\n; autoemit_temperature_commands = 1\n; avoid_crossing_curled_overhangs = 0\n; avoid_crossing_perimeters = 0\n; avoid_crossing_perimeters_max_detour = 0\n; bed_custom_model = \n; bed_custom_texture = \n; bed_shape = 0x0,180x0,180x180,0x180\n; bed_temperature = 60\n; before_layer_gcode = ;BEFORE_LAYER_CHANGE\\nG92 E0.0\\n;[layer_z]\\nM201 X{interpolate_table(extruded_weight_total, (0,4000), (1000,1700), (10000,1700))} Y{interpolate_table(extruded_weight_total, (0,4000), (1000,1700), (10000,1700))}\\n{if ! spiral_vase}M74 W[extruded_weight_total]{endif}\\n\n; between_objects_gcode = \n; binary_gcode = 0\n; bottom_fill_pattern = monotonic\n; bottom_solid_layers = 1\n; bottom_solid_min_thickness = 0.5\n; bridge_acceleration = 1500\n; bridge_angle = 0\n; bridge_fan_speed = 100\n; bridge_flow_ratio = 1\n; bridge_speed = 50\n; brim_separation = 0.1\n; brim_type = outer_only\n; brim_width = 0\n; color_change_gcode = M600\n; compatible_printers_condition_cummulative = \"printer_notes=~/.*MINIIS.*/ and nozzle_diameter[0]==0.4\";\"nozzle_diameter[0]!=0.8 and printer_notes=~/.*MINIIS.*/\"\n; complete_objects = 0\n; cooling = 1\n; cooling_tube_length = 5\n; cooling_tube_retraction = 91.5\n; default_acceleration = 2000\n; default_filament_profile = \"Prusament PLA @MINIIS\"\n; default_print_profile = 0.20mm SPEED @MINIIS 0.4\n; deretract_speed = 40\n; disable_fan_first_layers = 1\n; dont_support_bridges = 0\n; draft_shield = disabled\n; duplicate_distance = 6\n; elefant_foot_compensation = 0.2\n; enable_dynamic_fan_speeds = 0\n; enable_dynamic_overhang_speeds = 1\n; end_filament_gcode = \"; Filament-specific end gcode\"\n; end_gcode = {if max_layer_z < max_print_height}G1 Z{z_offset+min(max_layer_z+2, max_print_height)} F720 ; Move print head up{endif}\\nG1 X170 Y170 F4200 ; park print head\\n{if max_layer_z < max_print_height}G1 Z{z_offset+min(max_layer_z+50, max_print_height)} F720 ; Move print head further up{endif}\\nG4 ; wait\\nM104 S0 ; turn off temperature\\nM140 S0 ; turn off heatbed\\nM107 ; turn off fan\\nM221 S100 ; reset flow\\nM572 S0 ; reset PA\\nM569 S1 X Y ; reset to stealthchop for X Y\\nM84 ; disable motors\\n; max_layer_z = [max_layer_z]\n; external_perimeter_acceleration = 2000\n; external_perimeter_extrusion_width = 0.45\n; external_perimeter_speed = 140\n; external_perimeters_first = 0\n; extra_loading_move = -2\n; extra_perimeters = 0\n; extra_perimeters_on_overhangs = 0\n; extruder_clearance_height = 20\n; extruder_clearance_radius = 35\n; extruder_colour = \"\"\n; extruder_offset = 0x0\n; extrusion_axis = E\n; extrusion_multiplier = 1\n; extrusion_width = 0.45\n; fan_always_on = 1\n; fan_below_layer_time = 100\n; filament_colour = #FF8000\n; filament_cooling_final_speed = 3.4\n; filament_cooling_initial_speed = 2.2\n; filament_cooling_moves = 4\n; filament_cost = 25.4\n; filament_density = 1.24\n; filament_diameter = 1.75\n; filament_load_time = 0\n; filament_loading_speed = 28\n; filament_loading_speed_start = 3\n; filament_max_volumetric_speed = 14\n; filament_minimal_purge_on_wipe_tower = 15\n; filament_multitool_ramming = 0\n; filament_multitool_ramming_flow = 10\n; filament_multitool_ramming_volume = 10\n; filament_notes = \"\"\n; filament_ramming_parameters = \"120 100 6.6 6.8 7.2 7.6 7.9 8.2 8.7 9.4 9.9 10.0| 0.05 6.6 0.45 6.8 0.95 7.8 1.45 8.3 1.95 9.7 2.45 10 2.95 7.6 3.45 7.6 3.95 7.6 4.45 7.6 4.95 7.6\"\n; filament_settings_id = \"Generic PLA @MINIIS\"\n; filament_soluble = 0\n; filament_spool_weight = 0\n; filament_toolchange_delay = 0\n; filament_type = PLA\n; filament_unload_time = 0\n; filament_unloading_speed = 90\n; filament_unloading_speed_start = 100\n; filament_vendor = Generic\n; fill_angle = 0\n; fill_density = 15%\n; fill_pattern = grid\n; first_layer_acceleration = 500\n; first_layer_acceleration_over_raft = 0\n; first_layer_bed_temperature = 60\n; first_layer_extrusion_width = 0.5\n; first_layer_height = 0.2\n; first_layer_speed = 30\n; first_layer_speed_over_raft = 30\n; first_layer_temperature = 230\n; full_fan_speed_layer = 4\n; fuzzy_skin = none\n; fuzzy_skin_point_dist = 0.8\n; fuzzy_skin_thickness = 0.3\n; gap_fill_enabled = 1\n; gap_fill_speed = 80\n; gcode_comments = 0\n; gcode_flavor = marlin2\n; gcode_label_objects = firmware\n; gcode_resolution = 0.008\n; gcode_substitutions = \n; high_current_on_filament_swap = 0\n; host_type = prusalink\n; infill_acceleration = 4000\n; infill_anchor = 2.5\n; infill_anchor_max = 12\n; infill_every_layers = 1\n; infill_extruder = 1\n; infill_extrusion_width = 0.45\n; infill_first = 0\n; infill_overlap = 15%\n; infill_speed = 140\n; interface_shells = 0\n; ironing = 0\n; ironing_flowrate = 15%\n; ironing_spacing = 0.1\n; ironing_speed = 15\n; ironing_type = top\n; layer_gcode = ;AFTER_LAYER_CHANGE\\n;[layer_z]\n; layer_height = 0.2\n; machine_limits_usage = emit_to_gcode\n; machine_max_acceleration_e = 5000\n; machine_max_acceleration_extruding = 4000\n; machine_max_acceleration_retracting = 1250\n; machine_max_acceleration_travel = 4000\n; machine_max_acceleration_x = 4000\n; machine_max_acceleration_y = 4000\n; machine_max_acceleration_z = 400\n; machine_max_feedrate_e = 80\n; machine_max_feedrate_x = 400\n; machine_max_feedrate_y = 400\n; machine_max_feedrate_z = 12\n; machine_max_jerk_e = 10\n; machine_max_jerk_x = 8\n; machine_max_jerk_y = 8\n; machine_max_jerk_z = 2\n; machine_min_extruding_rate = 0\n; machine_min_travel_rate = 0\n; max_fan_speed = 100\n; max_layer_height = 0.25\n; max_print_height = 180\n; max_print_speed = 200\n; max_volumetric_extrusion_rate_slope_negative = 0\n; max_volumetric_extrusion_rate_slope_positive = 0\n; max_volumetric_speed = 0\n; min_bead_width = 85%\n; min_fan_speed = 100\n; min_feature_size = 25%\n; min_layer_height = 0.07\n; min_print_speed = 15\n; min_skirt_length = 4\n; mmu_segmented_region_interlocking_depth = 0\n; mmu_segmented_region_max_width = 0\n; notes = \n; nozzle_diameter = 0.4\n; only_retract_when_crossing_perimeters = 0\n; ooze_prevention = 0\n; output_filename_format = {input_filename_base}_0.4n_{layer_height}mm_{printing_filament_types}_{printer_model}_{print_time}.gcode\n; overhang_fan_speed_0 = 0\n; overhang_fan_speed_1 = 0\n; overhang_fan_speed_2 = 0\n; overhang_fan_speed_3 = 0\n; overhang_speed_0 = 15\n; overhang_speed_1 = 20\n; overhang_speed_2 = 25\n; overhang_speed_3 = 60\n; overhangs = 1\n; parking_pos_retraction = 92\n; pause_print_gcode = M601\n; perimeter_acceleration = 2500\n; perimeter_extruder = 1\n; perimeter_extrusion_width = 0.45\n; perimeter_generator = arachne\n; perimeter_speed = 140\n; perimeters = 1\n; physical_printer_settings_id = \n; post_process = \n; print_settings_id = 0.20mm SPEED @MINIIS 0.4\n; printer_model = MINIIS\n; printer_notes = Don\'t remove the following keywords! These keywords are used in the \"compatible printer\" condition of the print and filament profiles to link the particular print and filament profiles to this printer profile.\\nPRINTER_VENDOR_PRUSA3D\\nPRINTER_MODEL_MINIIS\\nNO_TEMPLATES\\n\n; printer_settings_id = Original Prusa MINI & MINI+ Input Shaper\n; printer_technology = FFF\n; printer_variant = 0.4\n; printer_vendor = \n; raft_contact_distance = 0.15\n; raft_expansion = 1.5\n; raft_first_layer_density = 80%\n; raft_first_layer_expansion = 3.5\n; raft_layers = 0\n; remaining_times = 1\n; resolution = 0\n; retract_before_travel = 1.5\n; retract_before_wipe = 70%\n; retract_layer_change = 1\n; retract_length = 2.5\n; retract_length_toolchange = 4\n; retract_lift = 0.2\n; retract_lift_above = 0\n; retract_lift_below = 179\n; retract_restart_extra = 0\n; retract_restart_extra_toolchange = 0\n; retract_speed = 70\n; seam_position = aligned\n; silent_mode = 0\n; single_extruder_multi_material = 0\n; single_extruder_multi_material_priming = 1\n; skirt_distance = 6\n; skirt_height = 1\n; skirts = 0\n; slice_closing_radius = 0.049\n; slicing_mode = regular\n; slowdown_below_layer_time = 10\n; small_perimeter_speed = 140\n; solid_infill_acceleration = 4000\n; solid_infill_below_area = 0\n; solid_infill_every_layers = 0\n; solid_infill_extruder = 1\n; solid_infill_extrusion_width = 0.45\n; solid_infill_speed = 140\n; spiral_vase = 0\n; staggered_inner_seams = 0\n; standby_temperature_delta = -5\n; start_filament_gcode = \"M572 S{if nozzle_diameter[0]==0.6}0.17{elsif nozzle_diameter[0]==0.8}0.12{elsif nozzle_diameter[0]==0.4}0.3{elsif nozzle_diameter[0]==0.25}0.85{else}0{endif}\"\n; start_gcode = M862.3 P \"MINI\" ; printer model check\\nM862.1 P[nozzle_diameter] ; nozzle diameter check\\nM862.5 P2 ; g-code level check\\nM862.6 P\"Input shaper\" ; FW feature check\\nM115 U5.1.2+13478\\nG90 ; use absolute coordinates\\nM83 ; extruder relative mode\\nM104 S170 ; set extruder temp for bed leveling\\nM140 S[first_layer_bed_temperature] ; set bed temp\\nM109 R170 ; wait for bed leveling temp\\nM190 S[first_layer_bed_temperature] ; wait for bed temp\\nM569 S1 X Y ; set stealthchop for X Y\\nM204 T1250 ; set travel acceleration\\nG28 ; home all without mesh bed level\\nG29 ; mesh bed leveling \\nM104 S[first_layer_temperature] ; set extruder temp\\nG92 E0\\n\\nG1 X0 Y-2 Z3 F2400\\n\\nM109 S[first_layer_temperature] ; wait for extruder temp\\n\\n; intro line\\nG1 X10 Z0.2 F1000\\nG1 X70 E8 F900\\nG1 X140 E10 F700\\nG92 E0\\n\\nM569 S0 X Y ; set spreadcycle for X Y\\nM204 T[machine_max_acceleration_travel] ; restore travel acceleration\\nM572 W0.06 ; set smooth time\\nM221 S95 ; set flow\\n\n; support_material = 0\n; support_material_angle = 0\n; support_material_auto = 1\n; support_material_bottom_contact_distance = 0\n; support_material_bottom_interface_layers = 0\n; support_material_buildplate_only = 0\n; support_material_closing_radius = 2\n; support_material_contact_distance = 0.2\n; support_material_enforce_layers = 0\n; support_material_extruder = 0\n; support_material_extrusion_width = 0.36\n; support_material_interface_contact_loops = 0\n; support_material_interface_extruder = 0\n; support_material_interface_layers = 5\n; support_material_interface_pattern = auto\n; support_material_interface_spacing = 0.2\n; support_material_interface_speed = 50%\n; support_material_pattern = rectilinear\n; support_material_spacing = 2\n; support_material_speed = 100\n; support_material_style = snug\n; support_material_synchronize_layers = 0\n; support_material_threshold = 40\n; support_material_with_sheath = 0\n; support_material_xy_spacing = 80%\n; support_tree_angle = 40\n; support_tree_angle_slow = 25\n; support_tree_branch_diameter = 2\n; support_tree_branch_diameter_angle = 5\n; support_tree_branch_diameter_double_wall = 3\n; support_tree_branch_distance = 1\n; support_tree_tip_diameter = 0.8\n; support_tree_top_rate = 30%\n; temperature = 220\n; template_custom_gcode = \n; thick_bridges = 0\n; thin_walls = 0\n; thumbnails = 16x16/QOI, 220x124/QOI, 200x240/QOI, 640x480/PNG\n; thumbnails_format = PNG\n; toolchange_gcode = \n; top_fill_pattern = monotoniclines\n; top_infill_extrusion_width = 0.42\n; top_solid_infill_acceleration = 1000\n; top_solid_infill_speed = 80\n; top_solid_layers = 0\n; top_solid_min_thickness = 0.7\n; travel_acceleration = 4000\n; travel_lift_before_obstacle = 0\n; travel_max_lift = 0\n; travel_ramping_lift = 0\n; travel_slope = 0\n; travel_speed = 400\n; travel_speed_z = 12\n; use_firmware_retraction = 0\n; use_relative_e_distances = 1\n; use_volumetric_e = 0\n; variable_layer_height = 1\n; wall_distribution_count = 1\n; wall_transition_angle = 10\n; wall_transition_filter_deviation = 25%\n; wall_transition_length = 100%\n; wipe = 0\n; wipe_into_infill = 0\n; wipe_into_objects = 0\n; wipe_tower = 0\n; wipe_tower_bridging = 10\n; wipe_tower_brim_width = 2\n; wipe_tower_cone_angle = 0\n; wipe_tower_extra_spacing = 100%\n; wipe_tower_extruder = 0\n; wipe_tower_no_sparse_layers = 0\n; wipe_tower_rotation_angle = 0\n; wipe_tower_width = 60\n; wipe_tower_x = 180\n; wipe_tower_y = 140\n; wiping_volumes_extruders = 70,70\n; wiping_volumes_matrix = 0\n; xy_size_compensation = 0\n; z_offset = 0\n; prusaslicer_config = end\n";
        // gcodeContent = await PrinterService.GetCurrentGCodeAsync();
        StateHasChanged(); // Trigger re-render to initialize viewer
    }

    public async ValueTask DisposeAsync()
    {
        //await JS.DestroyViewerAsync();
    }
}